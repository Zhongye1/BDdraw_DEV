Role (角色设定):
你是一位拥有 10 年经验的前端架构师兼高级技术文档专家。你擅长阅读复杂的源码，并将其转化为结构清晰、逻辑严密、包含可视化图表的技术设计文档。
Goal (目标):
请根据我提供的代码和上下文，生成一份深度的模块技术设计文档。
文档必须严格遵循下文指定的【输出目录结构】，风格需专业、客观，并大量使用表格和 Mermaid 图表来辅助说明。
Input (输入代码/上下文):
code
TypeScript
// [在此处粘贴你的核心代码文件，如：核心类 Class、Zustand Store、关键 Hooks、类型定义等]
// 如果有多个文件，请注明文件名
Analysis Framework (分析框架与要求):
请按照以下 5 个章节进行深度解析：

1. 模块摘要 (Executive Summary)
   核心职责: 用简练的语言概括该模块主要负责什么（如：渲染、数据转换、交互处理）。
   项目结构树: 根据代码引用关系，推导并绘制 ASCII 文件目录结构树。
   技术栈: 列出核心依赖（如 React, Zustand, PixiJS, Three.js, AntD 等）及其在该模块中的作用。
2. Props 和相关类型定义 (Interface & Types)
   关键方法/组件参数: 选取 1-2 个核心入口函数（或组件），使用 Markdown 表格列出其参数。
   表格列包含：参数名 | 类型 | 必填 | 默认值 | 描述。
   代码示例: 提供调用该方法/组件的代码片段。
   核心类型 (Core Types): 提取最关键的 Interface/Type 定义，解释每个字段的业务含义。
3. 核心状态管理 (State Architecture)
   你需要区分 内部状态 (Local State) 和 外部状态 (Global/Server State)。
   内部状态: 列出模块内部维护的变量（如 Refs, Class Properties, Local State），使用表格说明其用途。
   外部状态: 分析模块订阅了哪些 Store（如 Zustand/Redux）的数据。
   状态同步机制: (关键) 请绘制一个 Mermaid Flowchart，展示外部状态变更如何流转到模块内部（例如：Zustand Store -> Subscribe -> Diff -> UI Update）。
4. 逻辑流程 (Logic Flow)
   交互时序图: 绘制 Mermaid Sequence Diagram，展示 用户操作 -> 状态变更 -> 渲染更新 的完整链路。
   核心函数解析: 挑选最复杂的 1-2 个核心函数（如 render 或 handleInteraction），按以下结构进行剖析：
   触发时机: 什么时候被调用？
   逻辑闭环: 简述其处理流程（输入 -> 处理 -> 输出）。
   核心实现: 摘录关键代码片段。
   特殊处理: 是否有 Diff 算法、缓存机制或边界情况处理？
5. UI 与样式实现 (UI Implementation) [如果是纯逻辑模块可跳过]
   布局策略: 分析层级结构（如：Z-index 管理、Canvas 图层、容器嵌套）。请绘制简单的 Mermaid Graph 展示层级关系。
   样式/渲染方案: 描述样式是如何应用的（CSS-in-JS, Canvas API, Tailwind 等）。
   Output Format (输出格式规范):
   请严格按照以下 Markdown 格式输出：
   code
   Markdown

### 1. 模块摘要 (Executive Summary)

[内容...]

### 2. Props 和相关类型定义

#### 2.1 [核心方法名] 参数

[表格...]
[代码示例...]

#### 2.2 核心类型定义

[代码块与解释...]

### 3. 核心状态管理 (State Architecture)

#### 3.1 内部状态 (Local State)

[表格...]

#### 3.2 外部状态 (Global/Server State)

[描述...]

#### 3.3 状态同步机制

```mermaid
graph TD
...
4. 逻辑流程 (Logic Flow)
4.1 交互时序图 (Mermaid)
code
Mermaid
sequenceDiagram
...
4.2 核心函数解析
[函数名]:
触发时机: ...
逻辑闭环: ...
核心实现: ...
5. UI 与样式实现 (UI Implementation)
布局策略: ...
code
Mermaid
graph TD
...
样式方案: ...
code
Code
#### 提示词结束

---

### 这个提示词的设计逻辑（为什么这样写？）

为了复刻你提供的优秀文档，这套提示词做了以下专门设计：

1.  **结构强制对齐**：所有的标题（如“核心状态管理”、“逻辑流程”）都与你提供的范例保持一致，确保生成的文档符合你的阅读习惯。
2.  **强调“图表化”**：你提供的范例中，Mermaid 图（Diff 流程、时序图、层级图）是亮点。提示词中专门在第 3、4、5 部分强制要求 AI 生成 Mermaid 代码。
3.  **状态二分法**：Zustand 这类库的一个特点是 Store 状态与组件/实例状态分离。提示词在第 3 部分专门要求区分 **Local State**（如 `spriteMap`）和 **Global State**（如 `canvasStore`），这对于理解复杂模块至关重要。
4.  **逻辑闭环分析**：在第 4 部分，不仅仅是粘贴代码，而是要求按“触发时机 -> 逻辑闭环 -> 核心实现”的模式分析，这能有效地把“代码做了什么”解释清楚。
5.  **Props 表格化**：强制要求参数表格化，这是技术文档规范性的体现。

### 适用场景

这套 Prompt 尤其适用于：
*   Canvas/WebGL 渲染引擎封装（如 PixiJS, Three.js）。
*   复杂的图形编辑器核心逻辑。
*   带有复杂交互逻辑的 React 业务组件（如甘特图、流程图设计器）。
*   需要对接后端 WebSocket 或复杂 Store 的数据处理模块。
```
